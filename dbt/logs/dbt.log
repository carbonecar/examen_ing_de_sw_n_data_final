[0m02:05:31.254482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618179bacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761817007380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761816d59130>]}


============================== 02:05:31.293783 | 34c0d9cf-780f-4044-a7ab-c3c130cab089 ==============================
[0m02:05:31.293783 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:05:31.295631 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True'}
[0m02:05:31.110700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761816724b30>]}
[0m02:05:31.408842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761818fa4170>]}
[0m02:05:31.421701 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:05:31.785955 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:05:32.371309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:05:32.373459 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m02:05:34.059598 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m02:05:34.062649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618166b2e40>]}
[0m02:05:34.327039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a5a78c0>]}
[0m02:05:34.677494 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:05:34.683737 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:05:35.234722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a6187d0>]}
[0m02:05:35.236175 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m02:05:35.242312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a64c560>]}
[0m02:05:35.254896 [info ] [MainThread]: 
[0m02:05:35.257021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:05:35.258231 [info ] [MainThread]: 
[0m02:05:35.259819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:05:35.272696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m02:05:35.510475 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m02:05:35.513276 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m02:05:35.514706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:35.639779 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m02:05:35.644843 [debug] [ThreadPool]: On list_medallion: Close
[0m02:05:35.646897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m02:05:35.648180 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m02:05:35.668636 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.670745 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m02:05:35.672100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:35.680240 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m02:05:35.687412 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.688517 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m02:05:35.691836 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:05:35.693202 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.694481 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m02:05:35.700190 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:05:35.705706 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:05:35.708585 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.710109 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:05:35.716868 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:05:35.719107 [debug] [ThreadPool]: On create_medallion_main: Close
[0m02:05:35.727950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m02:05:35.749976 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:05:35.751358 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m02:05:35.752005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:35.755046 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:05:35.756118 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:05:35.758741 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m02:05:35.840540 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m02:05:35.847962 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m02:05:35.863486 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m02:05:35.866967 [debug] [ThreadPool]: On list_medallion_main: Close
[0m02:05:35.870675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a604a70>]}
[0m02:05:35.872494 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:35.873216 [debug] [MainThread]: On master: BEGIN
[0m02:05:35.873756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:05:35.876412 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m02:05:35.877189 [debug] [MainThread]: On master: COMMIT
[0m02:05:35.878032 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:35.878637 [debug] [MainThread]: On master: COMMIT
[0m02:05:35.881271 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:05:35.889443 [debug] [MainThread]: On master: Close
[0m02:05:35.919600 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m02:05:35.921455 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m02:05:35.922901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m02:05:35.923668 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m02:05:35.966603 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m02:05:35.971731 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m02:05:36.130318 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m02:05:36.133173 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:05:36.134749 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m02:05:36.136013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:36.139563 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:05:36.141923 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:05:36.144267 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:05:36.189744 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:05:36.192623 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:05:36.194775 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m02:05:36.235243 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m02:05:36.236577 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m02:05:36.243485 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:05:36.255184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a679940>]}
[0m02:05:36.258658 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.32s]
[0m02:05:36.260995 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m02:05:36.262487 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m02:05:36.267674 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m02:05:36.269882 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m02:05:36.271331 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m02:05:36.280291 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:36.282932 [debug] [MainThread]: On master: BEGIN
[0m02:05:36.284723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:36.290863 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m02:05:36.292256 [debug] [MainThread]: On master: COMMIT
[0m02:05:36.293733 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:36.295670 [debug] [MainThread]: On master: COMMIT
[0m02:05:36.304603 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m02:05:36.314472 [debug] [MainThread]: On master: Close
[0m02:05:36.318098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:36.319433 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m02:05:36.320555 [info ] [MainThread]: 
[0m02:05:36.321995 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m02:05:36.325304 [debug] [MainThread]: Command end result
[0m02:05:36.416471 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:05:36.428915 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:05:36.451436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m02:05:36.452510 [info ] [MainThread]: 
[0m02:05:36.453467 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:05:36.454355 [info ] [MainThread]: 
[0m02:05:36.455191 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m02:05:36.455976 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:05:36.456692 [info ] [MainThread]: 
[0m02:05:36.457447 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m02:05:36.458467 [info ] [MainThread]: 
[0m02:05:36.460664 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m02:05:36.463059 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:05:36.469605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.169751, "process_in_blocks": "328", "process_kernel_time": 6.389547, "process_mem_max_rss": "154568", "process_out_blocks": "3200", "process_user_time": 15.360568}
[0m02:05:36.471867 [debug] [MainThread]: Command `dbt run` failed at 02:05:36.471427 after 8.17 seconds
[0m02:05:36.473882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618176cd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618168478f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180838edb0>]}
[0m02:05:36.475663 [debug] [MainThread]: Flushing usage events
[0m02:05:37.680219 [debug] [MainThread]: An error was encountered while trying to flush usage events
