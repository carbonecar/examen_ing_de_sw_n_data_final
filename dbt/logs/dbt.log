[0m02:33:24.873636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed7b95e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed79a83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed8aa8f20>]}


============================== 02:33:24.882041 | d0171770-790a-4488-851b-139fd026a0a6 ==============================
[0m02:33:24.882041 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:33:24.883157 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'empty': 'False', 'no_print': 'None', 'quiet': 'False'}
[0m02:33:25.752638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0171770-790a-4488-851b-139fd026a0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed6c1b530>]}
[0m02:33:25.891039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0171770-790a-4488-851b-139fd026a0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed75b3d70>]}
[0m02:33:25.896956 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:33:26.110126 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:33:26.112265 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:33:26.113731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0171770-790a-4488-851b-139fd026a0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ecb1d7bc0>]}
[0m02:33:28.864350 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m02:33:28.865645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0171770-790a-4488-851b-139fd026a0a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed6d1a420>]}
[0m02:33:29.166451 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'
[0m02:33:29.170509 [error] [MainThread]: Traceback (most recent call last):
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 518, in load
    self.write_manifest_for_partial_parse()
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 828, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
         ^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'

[0m02:33:29.172217 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:33:29.175855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4333615, "process_in_blocks": "92312", "process_kernel_time": 2.362157, "process_mem_max_rss": "142372", "process_out_blocks": "24", "process_user_time": 7.007603}
[0m02:33:29.178200 [debug] [MainThread]: Command `dbt run` failed at 02:33:29.177688 after 4.44 seconds
[0m02:33:29.179531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed7d0b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed6b7f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6ed75b1940>]}
[0m02:33:29.180956 [debug] [MainThread]: Flushing usage events
[0m02:33:30.131937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:14.817887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71783f7af020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717840f63380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71783e6a9130>]}


============================== 02:34:14.828028 | 824663e7-d4bd-4228-85db-2395e7edc2c1 ==============================
[0m02:34:14.828028 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:34:14.829012 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'quiet': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m02:34:15.569675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '824663e7-d4bd-4228-85db-2395e7edc2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71783f633bf0>]}
[0m02:34:15.697371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '824663e7-d4bd-4228-85db-2395e7edc2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71783ec758b0>]}
[0m02:34:15.701862 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:15.964592 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:34:15.966307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:34:15.967032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '824663e7-d4bd-4228-85db-2395e7edc2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71783292fdd0>]}
[0m02:34:18.513229 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m02:34:18.514745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '824663e7-d4bd-4228-85db-2395e7edc2c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7178306bf020>]}
[0m02:34:18.740001 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'
[0m02:34:18.742919 [error] [MainThread]: Traceback (most recent call last):
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 518, in load
    self.write_manifest_for_partial_parse()
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 828, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
         ^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'

[0m02:34:18.744202 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:34:18.746560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.071247, "process_in_blocks": "0", "process_kernel_time": 1.477834, "process_mem_max_rss": "142356", "process_out_blocks": "32", "process_user_time": 6.195839}
[0m02:34:18.747427 [debug] [MainThread]: Command `dbt run` failed at 02:34:18.747236 after 4.07 seconds
[0m02:34:18.748141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71783ed86990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717830640170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717830641eb0>]}
[0m02:34:18.748859 [debug] [MainThread]: Flushing usage events
[0m02:34:19.666751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:07:53.665194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62cfc69be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62cfc1fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62d09855e0>]}


============================== 03:07:53.679583 | 4f07b419-ebca-4d6f-ba07-91facaab79f7 ==============================
[0m03:07:53.679583 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:07:53.680628 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m03:07:54.584856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f07b419-ebca-4d6f-ba07-91facaab79f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62cf1ecfe0>]}
[0m03:07:54.706316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f07b419-ebca-4d6f-ba07-91facaab79f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62cf8584a0>]}
[0m03:07:54.712383 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:07:54.919074 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:07:54.920406 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:07:54.921170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f07b419-ebca-4d6f-ba07-91facaab79f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62c301ffe0>]}
[0m03:07:57.492200 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m03:07:57.493472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f07b419-ebca-4d6f-ba07-91facaab79f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62c0f240b0>]}
[0m03:07:57.663391 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'
[0m03:07:57.665992 [error] [MainThread]: Traceback (most recent call last):
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 518, in load
    self.write_manifest_for_partial_parse()
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 828, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
         ^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'

[0m03:07:57.667275 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:07:57.671805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1172237, "process_in_blocks": "0", "process_kernel_time": 1.701556, "process_mem_max_rss": "142952", "process_out_blocks": "24", "process_user_time": 6.165117}
[0m03:07:57.672660 [debug] [MainThread]: Command `dbt run` failed at 03:07:57.672495 after 4.12 seconds
[0m03:07:57.673342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62cf927d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62c0e54d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d62c0ea8ef0>]}
[0m03:07:57.674005 [debug] [MainThread]: Flushing usage events
[0m03:07:58.651580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:14:55.266046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c5ceaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c4c3fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c7733710>]}


============================== 03:14:55.278674 | 4343c5fd-9693-47d4-9b65-11a768dc19a8 ==============================
[0m03:14:55.278674 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:14:55.279745 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'warn_error': 'None', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False'}
[0m03:14:56.137214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4343c5fd-9693-47d4-9b65-11a768dc19a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c5ab6990>]}
[0m03:14:56.267924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4343c5fd-9693-47d4-9b65-11a768dc19a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c51d8a70>]}
[0m03:14:56.273486 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:14:56.454139 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:14:56.455846 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:14:56.456733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4343c5fd-9693-47d4-9b65-11a768dc19a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c4a87110>]}
[0m03:14:59.076675 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m03:14:59.078950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4343c5fd-9693-47d4-9b65-11a768dc19a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484b8e43f50>]}
[0m03:14:59.263907 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'
[0m03:14:59.266621 [error] [MainThread]: Traceback (most recent call last):
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 518, in load
    self.write_manifest_for_partial_parse()
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 828, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
         ^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'

[0m03:14:59.267870 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:14:59.270900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1186094, "process_in_blocks": "0", "process_kernel_time": 2.520186, "process_mem_max_rss": "142316", "process_out_blocks": "16", "process_user_time": 6.487293}
[0m03:14:59.271962 [debug] [MainThread]: Command `dbt run` failed at 03:14:59.271766 after 4.12 seconds
[0m03:14:59.272710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c53f0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74849ac20ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7484c7470ec0>]}
[0m03:14:59.273386 [debug] [MainThread]: Flushing usage events
[0m03:15:00.239882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:16:10.064172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113fccec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114153bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113f099130>]}


============================== 03:16:10.103332 | 60031624-9ce5-45a3-8597-f0814fc23ba9 ==============================
[0m03:16:10.103332 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:16:10.105051 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs'}
[0m03:16:11.139345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60031624-9ce5-45a3-8597-f0814fc23ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1132fa71d0>]}
[0m03:16:11.266658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60031624-9ce5-45a3-8597-f0814fc23ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1132fc0470>]}
[0m03:16:11.271682 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:16:11.466059 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:16:11.468431 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:16:11.469294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60031624-9ce5-45a3-8597-f0814fc23ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113ead8800>]}
[0m03:16:13.947929 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m03:16:13.949977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60031624-9ce5-45a3-8597-f0814fc23ba9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1132fa7ef0>]}
[0m03:16:14.161920 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'
[0m03:16:14.165788 [error] [MainThread]: Traceback (most recent call last):
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2123, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 320, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 518, in load
    self.write_manifest_for_partial_parse()
  File "/home/nilay/examen_ing_de_sw_n_data_final/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 828, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
         ^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/nilay/examen_ing_de_sw_n_data_final/dbt/target/partial_parse.msgpack'

[0m03:16:14.167481 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:16:14.172167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.252385, "process_in_blocks": "0", "process_kernel_time": 1.822403, "process_mem_max_rss": "142812", "process_out_blocks": "16", "process_user_time": 6.272459}
[0m03:16:14.173960 [debug] [MainThread]: Command `dbt run` failed at 03:16:14.173704 after 4.26 seconds
[0m03:16:14.174864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113ef39880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1132e01f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1132e01ac0>]}
[0m03:16:14.175815 [debug] [MainThread]: Flushing usage events
[0m03:16:15.034156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:20:18.122112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf73e2a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf742b9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf73e2b5f0>]}


============================== 03:20:18.137666 | 0c8cab74-9088-47cb-8ac6-83ed1b493116 ==============================
[0m03:20:18.137666 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:20:18.138960 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m03:20:18.981411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf742748f0>]}
[0m03:20:19.133757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf743e8a40>]}
[0m03:20:19.155548 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:20:19.346779 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:20:19.347942 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:20:19.348655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf6796c7d0>]}
[0m03:20:21.740416 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m03:20:21.741789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf67856ff0>]}
[0m03:20:22.001891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf03360b60>]}
[0m03:20:22.151390 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:20:22.160863 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:20:22.250763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf03345fd0>]}
[0m03:20:22.251797 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:20:22.252522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf033d6390>]}
[0m03:20:22.256264 [info ] [MainThread]: 
[0m03:20:22.257062 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:20:22.257720 [info ] [MainThread]: 
[0m03:20:22.258948 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:20:22.270040 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:20:22.519843 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:20:22.521300 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:20:22.522018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:24.171433 [debug] [ThreadPool]: SQL status: OK in 1.649 seconds
[0m03:20:24.180997 [debug] [ThreadPool]: On list_medallion: Close
[0m03:20:24.183104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:20:24.184917 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:20:24.196959 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:20:24.197777 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:20:24.198324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:20:24.203997 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m03:20:24.206607 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:20:24.207307 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:20:24.208832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:20:24.209369 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:20:24.209838 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:20:24.214769 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:20:24.216493 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:20:24.217133 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:20:24.217626 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:20:24.219641 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:20:24.220274 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:20:24.223159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:20:24.233359 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:20:24.234135 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:20:24.234845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:20:24.237147 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:20:24.238001 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:20:24.238762 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:20:24.303947 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m03:20:24.307031 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:20:24.311572 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:20:24.313122 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:20:24.316607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf67834920>]}
[0m03:20:24.317568 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:24.318184 [debug] [MainThread]: On master: BEGIN
[0m03:20:24.318823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:20:24.320555 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:20:24.321137 [debug] [MainThread]: On master: COMMIT
[0m03:20:24.321629 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:24.322136 [debug] [MainThread]: On master: COMMIT
[0m03:20:24.323564 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:20:24.324195 [debug] [MainThread]: On master: Close
[0m03:20:24.351729 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:20:24.352873 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:20:24.353844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:20:24.354478 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:20:24.371556 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:20:24.389708 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:20:24.445013 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:20:24.453186 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:20:24.454511 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:20:24.455192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:20:24.457610 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:20:24.458405 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:20:24.459126 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:20:24.491511 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:20:24.492790 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:20:24.493797 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:20:24.515811 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:20:24.516630 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:20:24.520370 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:20:24.523948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c8cab74-9088-47cb-8ac6-83ed1b493116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf67854d40>]}
[0m03:20:24.525144 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.17s]
[0m03:20:24.526542 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:20:24.527893 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:20:24.535554 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:20:24.538424 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:20:24.539301 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:20:24.543457 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:24.544153 [debug] [MainThread]: On master: BEGIN
[0m03:20:24.544735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:20:24.556040 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m03:20:24.556810 [debug] [MainThread]: On master: COMMIT
[0m03:20:24.557359 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:24.558022 [debug] [MainThread]: On master: COMMIT
[0m03:20:24.559607 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:20:24.560207 [debug] [MainThread]: On master: Close
[0m03:20:24.560939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:20:24.561549 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:20:24.562202 [info ] [MainThread]: 
[0m03:20:24.563274 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m03:20:24.564553 [debug] [MainThread]: Command end result
[0m03:20:24.636009 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:20:24.639776 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:20:24.650530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:20:24.651253 [info ] [MainThread]: 
[0m03:20:24.652185 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:20:24.652850 [info ] [MainThread]: 
[0m03:20:24.653675 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:20:24.654611 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:20:24.655262 [info ] [MainThread]: 
[0m03:20:24.656015 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:20:24.656608 [info ] [MainThread]: 
[0m03:20:24.657263 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:20:24.658442 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:20:24.663436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.654019, "process_in_blocks": "14376", "process_kernel_time": 2.707136, "process_mem_max_rss": "205676", "process_out_blocks": "45008", "process_user_time": 8.218788}
[0m03:20:24.664352 [debug] [MainThread]: Command `dbt run` failed at 03:20:24.664178 after 6.66 seconds
[0m03:20:24.665079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf7362cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf742b9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bf73d20aa0>]}
[0m03:20:24.665729 [debug] [MainThread]: Flushing usage events
[0m03:20:25.703070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:20:56.747327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564ebdbc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564ed679100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564eafe9430>]}


============================== 03:20:56.766426 | 2c3b2458-88b5-4985-a78b-1666a9d50590 ==============================
[0m03:20:56.766426 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:20:56.767676 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'static_parser': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m03:20:59.590610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564ed3f9280>]}
[0m03:20:59.712259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564eac11b80>]}
[0m03:20:59.868749 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:21:00.166126 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:21:00.440679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:21:00.441689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:21:00.524378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564defbbe00>]}
[0m03:21:00.915592 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:21:00.951201 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:21:01.015668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564deeb5a60>]}
[0m03:21:01.016933 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:21:01.017664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564def1f470>]}
[0m03:21:01.021809 [info ] [MainThread]: 
[0m03:21:01.022862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:21:01.023662 [info ] [MainThread]: 
[0m03:21:01.024868 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:21:01.034297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:21:01.194083 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:21:01.194992 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:21:01.195707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:01.319772 [debug] [ThreadPool]: SQL status: OK in 0.124 seconds
[0m03:21:01.324429 [debug] [ThreadPool]: On list_medallion: Close
[0m03:21:01.326480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:21:01.328271 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:21:01.340518 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:01.341224 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:21:01.341715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:01.362628 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m03:21:01.365056 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:01.365663 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:21:01.367529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:01.368066 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:01.368635 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:21:01.648258 [debug] [ThreadPool]: SQL status: OK in 0.279 seconds
[0m03:21:01.650222 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:21:01.650835 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:01.651312 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:21:01.653747 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:21:01.654706 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:21:01.657942 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m03:21:01.667791 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:21:01.668615 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:21:01.669151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:01.671296 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:21:01.671853 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:21:01.672374 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:21:01.779042 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m03:21:01.781991 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:21:01.785748 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:21:01.786552 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:21:01.788452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564deeb5d60>]}
[0m03:21:01.789295 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:01.789796 [debug] [MainThread]: On master: BEGIN
[0m03:21:01.790411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:21:01.792247 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:21:01.792819 [debug] [MainThread]: On master: COMMIT
[0m03:21:01.793319 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:01.793838 [debug] [MainThread]: On master: COMMIT
[0m03:21:01.795430 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:01.796038 [debug] [MainThread]: On master: Close
[0m03:21:01.812669 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:21:01.814215 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:21:01.815573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:21:01.816516 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:21:01.845619 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:21:01.924673 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:21:01.986245 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:21:02.117722 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:21:02.119332 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:21:02.120609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:21:02.124002 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:21:02.124774 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:21:02.125556 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:21:03.095659 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:21:03.096876 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:21:03.097944 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:21:03.220293 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:21:03.223655 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:21:03.231816 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:21:03.237212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3b2458-88b5-4985-a78b-1666a9d50590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564def51d60>]}
[0m03:21:03.239521 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 1.42s]
[0m03:21:03.242214 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:21:03.244012 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:21:03.248614 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:21:03.250816 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:21:03.252323 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:21:03.258472 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:03.259870 [debug] [MainThread]: On master: BEGIN
[0m03:21:03.261024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:21:03.263867 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m03:21:03.264798 [debug] [MainThread]: On master: COMMIT
[0m03:21:03.265580 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:03.266439 [debug] [MainThread]: On master: COMMIT
[0m03:21:03.268510 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:03.269517 [debug] [MainThread]: On master: Close
[0m03:21:03.271265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:03.272411 [debug] [MainThread]: Connection 'create_medallion_main' was properly closed.
[0m03:21:03.273439 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:21:03.274984 [info ] [MainThread]: 
[0m03:21:03.276519 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m03:21:03.279206 [debug] [MainThread]: Command end result
[0m03:21:03.752240 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:21:03.757336 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:21:03.768251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:21:03.769083 [info ] [MainThread]: 
[0m03:21:03.770029 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:21:03.770853 [info ] [MainThread]: 
[0m03:21:03.771705 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:21:03.772835 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:21:03.773652 [info ] [MainThread]: 
[0m03:21:03.774787 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:21:03.775463 [info ] [MainThread]: 
[0m03:21:03.776127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:21:03.787198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.2187767, "process_in_blocks": "0", "process_kernel_time": 5.137761, "process_mem_max_rss": "152128", "process_out_blocks": "2168", "process_user_time": 10.372182}
[0m03:21:03.788223 [debug] [MainThread]: Command `dbt run` failed at 03:21:03.788044 after 7.22 seconds
[0m03:21:03.789054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564eafe9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564eaa72db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564def52ab0>]}
[0m03:21:03.789753 [debug] [MainThread]: Flushing usage events
[0m03:21:05.424372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:21:28.237006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbdcbef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbd552e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbd552ed0>]}


============================== 03:21:28.251013 | a7a81786-0526-4aa6-b374-cd8f21e42357 ==============================
[0m03:21:28.251013 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:21:28.252015 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'version_check': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m03:21:28.871914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbf831160>]}
[0m03:21:28.992390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecb11f6060>]}
[0m03:21:28.996149 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:21:29.203984 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:21:29.427364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:21:29.428139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:21:29.497137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecb110ede0>]}
[0m03:21:29.640832 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:21:29.680319 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:21:29.724599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec8af55dc0>]}
[0m03:21:29.725489 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:21:29.726177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ec8af41040>]}
[0m03:21:29.729601 [info ] [MainThread]: 
[0m03:21:29.730299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:21:29.730974 [info ] [MainThread]: 
[0m03:21:29.731939 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:21:29.740558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:21:29.839935 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:21:29.840883 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:21:29.841415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:29.880746 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m03:21:29.883130 [debug] [ThreadPool]: On list_medallion: Close
[0m03:21:29.884685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:21:29.885472 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:21:29.896764 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:29.897344 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:21:29.897833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:29.900130 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:21:29.902265 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:29.902783 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:21:29.904226 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:29.904987 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:29.905552 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:21:29.907486 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:29.908947 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:21:29.909547 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:29.910021 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:21:29.911274 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:29.911804 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:21:29.914299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:21:29.923970 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:21:29.924909 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:21:29.925512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:29.927501 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:21:29.928034 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:21:29.928759 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:21:29.951035 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m03:21:29.953908 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:21:29.955998 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:21:29.956820 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:21:29.958199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbf7083e0>]}
[0m03:21:29.959017 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:29.959529 [debug] [MainThread]: On master: BEGIN
[0m03:21:29.960091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:21:29.961688 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:21:29.962235 [debug] [MainThread]: On master: COMMIT
[0m03:21:29.962773 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:29.963344 [debug] [MainThread]: On master: COMMIT
[0m03:21:29.964645 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:29.965205 [debug] [MainThread]: On master: Close
[0m03:21:29.972837 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:21:29.973891 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:21:29.974825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:21:29.975417 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:21:29.991959 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:21:29.993296 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:21:30.044974 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:21:30.046531 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:21:30.047302 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:21:30.047866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:21:30.050154 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:21:30.050796 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:21:30.051384 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:21:30.053065 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:21:30.053785 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:21:30.054653 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:21:30.061150 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:21:30.061858 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:21:30.065446 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:21:30.068293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7a81786-0526-4aa6-b374-cd8f21e42357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecb13d77d0>]}
[0m03:21:30.069485 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.09s]
[0m03:21:30.070605 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:21:30.071677 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:21:30.074367 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:21:30.076540 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:21:30.077373 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:21:30.081772 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:30.082329 [debug] [MainThread]: On master: BEGIN
[0m03:21:30.082860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:21:30.084346 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:30.085188 [debug] [MainThread]: On master: COMMIT
[0m03:21:30.085770 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:30.086354 [debug] [MainThread]: On master: COMMIT
[0m03:21:30.087555 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:30.088232 [debug] [MainThread]: On master: Close
[0m03:21:30.089096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:30.089566 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:21:30.090156 [info ] [MainThread]: 
[0m03:21:30.090796 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m03:21:30.092101 [debug] [MainThread]: Command end result
[0m03:21:30.139217 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:21:30.142343 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:21:30.152334 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:21:30.153095 [info ] [MainThread]: 
[0m03:21:30.153887 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:21:30.154591 [info ] [MainThread]: 
[0m03:21:30.155401 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:21:30.156202 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:21:30.156906 [info ] [MainThread]: 
[0m03:21:30.157640 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:21:30.158299 [info ] [MainThread]: 
[0m03:21:30.159004 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:21:30.160794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.034289, "process_in_blocks": "0", "process_kernel_time": 1.474176, "process_mem_max_rss": "152916", "process_out_blocks": "2168", "process_user_time": 3.943025}
[0m03:21:30.161588 [debug] [MainThread]: Command `dbt run` failed at 03:21:30.161409 after 2.04 seconds
[0m03:21:30.162200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbd2a5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecb12819a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ecbd721160>]}
[0m03:21:30.163071 [debug] [MainThread]: Flushing usage events
[0m03:21:31.007582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:21:48.758778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796533b17e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79653366f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796533b16720>]}


============================== 03:21:48.764958 | 90ad0254-e3f5-4b81-bdad-e7a08bbaa5db ==============================
[0m03:21:48.764958 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:21:48.766022 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'target_path': 'None', 'version_check': 'True', 'use_colors': 'True', 'empty': 'False'}
[0m03:21:49.217606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796535af1100>]}
[0m03:21:49.339731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796534d715b0>]}
[0m03:21:49.343468 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:21:49.578810 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:21:49.839807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:21:49.840694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:21:49.920282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965330ee1b0>]}
[0m03:21:50.056669 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:21:50.060282 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:21:50.086560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796525240b00>]}
[0m03:21:50.087576 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:21:50.088443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965275ccc20>]}
[0m03:21:50.092135 [info ] [MainThread]: 
[0m03:21:50.092957 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:21:50.093650 [info ] [MainThread]: 
[0m03:21:50.094808 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:21:50.103667 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:21:50.180380 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:21:50.181151 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:21:50.181667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:50.218521 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m03:21:50.221167 [debug] [ThreadPool]: On list_medallion: Close
[0m03:21:50.222722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:21:50.223570 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:21:50.235250 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:50.235914 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:21:50.236397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:50.239927 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:21:50.242275 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:50.242838 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:21:50.244297 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:50.244869 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:50.245423 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:21:50.247115 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:50.248397 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:21:50.248980 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:21:50.249456 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:21:50.250737 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:21:50.251270 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:21:50.253800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:21:50.263177 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:21:50.263720 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:21:50.264178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:50.265763 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:21:50.266517 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:21:50.267015 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:21:50.289380 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m03:21:50.291987 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:21:50.293826 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:21:50.294425 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:21:50.295706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965273fa4e0>]}
[0m03:21:50.296489 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:50.296991 [debug] [MainThread]: On master: BEGIN
[0m03:21:50.297547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:21:50.299137 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:21:50.299674 [debug] [MainThread]: On master: COMMIT
[0m03:21:50.300153 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:50.300602 [debug] [MainThread]: On master: COMMIT
[0m03:21:50.301985 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:50.302551 [debug] [MainThread]: On master: Close
[0m03:21:50.309463 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:21:50.310595 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:21:50.311485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:21:50.312066 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:21:50.328936 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:21:50.332124 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:21:50.385551 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:21:50.390989 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:21:50.391752 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:21:50.392348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:21:50.394485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:21:50.395140 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:21:50.395709 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:21:50.397267 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:21:50.397890 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:21:50.398796 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:21:50.405930 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:21:50.406663 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:21:50.410153 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:21:50.412819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ad0254-e3f5-4b81-bdad-e7a08bbaa5db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79652466bc20>]}
[0m03:21:50.413846 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.10s]
[0m03:21:50.415086 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:21:50.416158 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:21:50.418997 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:21:50.420820 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:21:50.421638 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:21:50.426059 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:50.426764 [debug] [MainThread]: On master: BEGIN
[0m03:21:50.427339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:21:50.429078 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:21:50.429634 [debug] [MainThread]: On master: COMMIT
[0m03:21:50.430362 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:50.430877 [debug] [MainThread]: On master: COMMIT
[0m03:21:50.432373 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:21:50.433089 [debug] [MainThread]: On master: Close
[0m03:21:50.433768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:50.434716 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:21:50.435260 [info ] [MainThread]: 
[0m03:21:50.435953 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m03:21:50.437174 [debug] [MainThread]: Command end result
[0m03:21:50.475358 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:21:50.478902 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:21:50.488887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:21:50.489677 [info ] [MainThread]: 
[0m03:21:50.490551 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:21:50.491240 [info ] [MainThread]: 
[0m03:21:50.492051 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:21:50.492827 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:21:50.493429 [info ] [MainThread]: 
[0m03:21:50.494307 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:21:50.495004 [info ] [MainThread]: 
[0m03:21:50.495654 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:21:50.497485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8461936, "process_in_blocks": "8", "process_kernel_time": 0.883188, "process_mem_max_rss": "152884", "process_out_blocks": "2168", "process_user_time": 3.952563}
[0m03:21:50.498441 [debug] [MainThread]: Command `dbt run` failed at 03:21:50.498265 after 1.85 seconds
[0m03:21:50.499053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796535d71520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965359d02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796527360050>]}
[0m03:21:50.499830 [debug] [MainThread]: Flushing usage events
[0m03:21:51.224611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:22:23.044861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452105b6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520fa92630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520f981130>]}


============================== 03:22:23.061394 | c974fece-58d0-4846-8f73-952185439300 ==============================
[0m03:22:23.061394 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:22:23.062818 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'False', 'no_print': 'None'}
[0m03:22:24.004518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520f2e21b0>]}
[0m03:22:24.144517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520f45d6a0>]}
[0m03:22:24.324888 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:22:24.527854 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:22:24.781638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:22:24.782373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:22:24.852224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452037aefc0>]}
[0m03:22:24.994168 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:22:24.997359 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:22:25.077407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452014308f0>]}
[0m03:22:25.078251 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:22:25.079084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452037c1a90>]}
[0m03:22:25.082569 [info ] [MainThread]: 
[0m03:22:25.083370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:22:25.083982 [info ] [MainThread]: 
[0m03:22:25.084954 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:22:25.094088 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:22:25.227211 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:22:25.227940 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:22:25.228452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:25.319728 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m03:22:25.323906 [debug] [ThreadPool]: On list_medallion: Close
[0m03:22:25.325656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:22:25.327699 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:22:25.341321 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:25.342138 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:22:25.342646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:25.347329 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:22:25.349771 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:25.350333 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:22:25.351893 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:22:25.352463 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:25.353046 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:22:25.357029 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:22:25.359254 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:22:25.359974 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:25.360557 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:22:25.363216 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:22:25.363994 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:22:25.367217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:22:25.376886 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:22:25.377586 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:22:25.378317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:25.380069 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:22:25.380771 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:22:25.381560 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:22:25.426724 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m03:22:25.429329 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:22:25.433010 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:22:25.433607 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:22:25.435028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520f184140>]}
[0m03:22:25.435855 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:25.436483 [debug] [MainThread]: On master: BEGIN
[0m03:22:25.436970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:22:25.438584 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:22:25.439356 [debug] [MainThread]: On master: COMMIT
[0m03:22:25.439879 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:25.440474 [debug] [MainThread]: On master: COMMIT
[0m03:22:25.442432 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:22:25.443738 [debug] [MainThread]: On master: Close
[0m03:22:25.454644 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:22:25.456262 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:22:25.457265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:22:25.457980 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:22:25.477752 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:22:25.482416 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:22:25.559606 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:22:25.562864 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:22:25.563882 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:22:25.564546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:22:25.567351 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:22:25.568077 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:22:25.568968 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:22:25.593777 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:22:25.595307 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:22:25.596835 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:22:25.621803 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:22:25.622812 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:22:25.627862 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:22:25.632529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c974fece-58d0-4846-8f73-952185439300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520149cb30>]}
[0m03:22:25.634534 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.17s]
[0m03:22:25.636420 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:22:25.637947 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:22:25.642750 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:22:25.644197 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:22:25.645413 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:22:25.650932 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:25.651843 [debug] [MainThread]: On master: BEGIN
[0m03:22:25.652646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:22:25.654722 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:22:25.655788 [debug] [MainThread]: On master: COMMIT
[0m03:22:25.656742 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:25.657402 [debug] [MainThread]: On master: COMMIT
[0m03:22:25.659265 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:22:25.660021 [debug] [MainThread]: On master: Close
[0m03:22:25.661238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:22:25.661901 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:22:25.662647 [info ] [MainThread]: 
[0m03:22:25.663675 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m03:22:25.665449 [debug] [MainThread]: Command end result
[0m03:22:25.712405 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:22:25.715834 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:22:25.726789 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:22:25.727483 [info ] [MainThread]: 
[0m03:22:25.728253 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:22:25.728943 [info ] [MainThread]: 
[0m03:22:25.729737 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:22:25.730509 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:22:25.731133 [info ] [MainThread]: 
[0m03:22:25.731893 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:22:25.732590 [info ] [MainThread]: 
[0m03:22:25.733235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:22:25.740157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8043065, "process_in_blocks": "0", "process_kernel_time": 2.143805, "process_mem_max_rss": "152528", "process_out_blocks": "2168", "process_user_time": 4.767756}
[0m03:22:25.741128 [debug] [MainThread]: Command `dbt run` failed at 03:22:25.740945 after 2.81 seconds
[0m03:22:25.741936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520fd33560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520f981130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74520fbb4440>]}
[0m03:22:25.742609 [debug] [MainThread]: Flushing usage events
[0m03:22:26.697306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:22:44.745178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b032ce8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b022282c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b021fdc40>]}


============================== 03:22:44.751573 | 3fca4c17-006b-463e-aede-70b9afd493dd ==============================
[0m03:22:44.751573 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:22:44.752687 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'log_format': 'default', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True'}
[0m03:22:45.207460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b049bd0d0>]}
[0m03:22:45.334984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b01f794c0>]}
[0m03:22:45.338185 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:22:45.509444 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:22:45.695780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:22:45.696499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:22:45.775088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af6306c30>]}
[0m03:22:45.909964 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:22:45.914684 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:22:45.938454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af4150c50>]}
[0m03:22:45.939442 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:22:45.940176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af656c4a0>]}
[0m03:22:45.943659 [info ] [MainThread]: 
[0m03:22:45.944452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:22:45.945074 [info ] [MainThread]: 
[0m03:22:45.946010 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:22:45.954779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:22:45.113836 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:22:45.114623 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:22:45.115243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:45.174951 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m03:22:45.177887 [debug] [ThreadPool]: On list_medallion: Close
[0m03:22:45.179519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:22:45.180534 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:22:45.194556 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:45.195320 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:22:45.196065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:45.199172 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:22:45.201849 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:45.202540 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:22:45.204492 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:22:45.205153 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:45.205806 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:22:45.208126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:22:45.210080 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:22:45.210780 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:22:45.211383 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:22:45.213327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:22:45.214167 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:22:45.217994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:22:45.238293 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:22:45.239560 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:22:45.240609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:45.243127 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:22:45.244299 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:22:45.244982 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:22:45.269395 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m03:22:45.272207 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:22:45.274314 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:22:45.274986 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:22:45.276627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af413de80>]}
[0m03:22:45.277910 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:45.278509 [debug] [MainThread]: On master: BEGIN
[0m03:22:45.279052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:22:45.281021 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:22:45.281622 [debug] [MainThread]: On master: COMMIT
[0m03:22:45.282337 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:45.282837 [debug] [MainThread]: On master: COMMIT
[0m03:22:45.284399 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:22:45.284990 [debug] [MainThread]: On master: Close
[0m03:22:45.293694 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:22:45.295442 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:22:45.296844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:22:45.297701 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:22:45.317754 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:22:45.319381 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:22:45.379834 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:22:45.381421 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:22:45.382103 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:22:45.382884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:22:45.385150 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:22:45.385866 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:22:45.386463 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:22:45.388035 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:22:45.388747 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:22:45.389534 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:22:45.396278 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:22:45.396994 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:22:45.400717 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:22:45.403434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fca4c17-006b-463e-aede-70b9afd493dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b030023c0>]}
[0m03:22:45.404644 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.10s]
[0m03:22:45.405784 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:22:45.406907 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:22:45.410020 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:22:45.410951 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:22:45.411966 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:22:45.415822 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:45.416440 [debug] [MainThread]: On master: BEGIN
[0m03:22:45.417010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:22:45.418517 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:22:45.419083 [debug] [MainThread]: On master: COMMIT
[0m03:22:45.419585 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:45.420305 [debug] [MainThread]: On master: COMMIT
[0m03:22:45.421472 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:22:45.422206 [debug] [MainThread]: On master: Close
[0m03:22:45.422868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:22:45.423450 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:22:45.424152 [info ] [MainThread]: 
[0m03:22:45.424809 [info ] [MainThread]: Finished running 1 table model, 1 view model in -1 hours 59 minutes and 59.48 seconds (-0.52s).
[0m03:22:45.426057 [debug] [MainThread]: Command end result
[0m03:22:45.463473 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:22:45.466972 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:22:45.477816 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:22:45.478629 [info ] [MainThread]: 
[0m03:22:45.479438 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:22:45.480203 [info ] [MainThread]: 
[0m03:22:45.480966 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:22:45.481762 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:22:45.482349 [info ] [MainThread]: 
[0m03:22:45.483102 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:22:45.483925 [info ] [MainThread]: 
[0m03:22:45.484611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:22:45.486952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7618169, "process_in_blocks": "0", "process_kernel_time": 0.742462, "process_mem_max_rss": "153484", "process_out_blocks": "2168", "process_user_time": 3.774508}
[0m03:22:45.487867 [debug] [MainThread]: Command `dbt run` failed at 03:22:45.487617 after 1.76 seconds
[0m03:22:45.488543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b045ca060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b02fe4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781af64823f0>]}
[0m03:22:45.489150 [debug] [MainThread]: Flushing usage events
[0m03:22:46.294284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:23:03.459187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ae7418e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2aeb303e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ae118c50>]}


============================== 03:23:03.465320 | 07d023d9-0c67-4ec3-976e-86d78ff89d2c ==============================
[0m03:23:03.465320 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:23:03.466352 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m03:23:03.903605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ae584fe0>]}
[0m03:23:04.019632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ae8130b0>]}
[0m03:23:04.022524 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:23:04.187861 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:23:04.369880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:23:04.370597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:23:04.438434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2a211cd10>]}
[0m03:23:04.561410 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:23:04.564428 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:23:04.588295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2a0040dd0>]}
[0m03:23:04.589119 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:23:04.589789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2a000d8e0>]}
[0m03:23:04.593154 [info ] [MainThread]: 
[0m03:23:04.593887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:23:04.594558 [info ] [MainThread]: 
[0m03:23:04.595537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:23:04.604158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:23:04.674399 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:23:04.675285 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:23:04.676081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:04.707295 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m03:23:04.709779 [debug] [ThreadPool]: On list_medallion: Close
[0m03:23:04.711207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:23:04.712123 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:23:04.723940 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:04.724621 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:23:04.725287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:04.728207 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:23:04.730530 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:04.731095 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:23:04.732711 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:04.733265 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:04.733737 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:23:04.734883 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:04.736419 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:23:04.737056 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:04.737517 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:23:04.738601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:04.739135 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:23:04.741626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:23:04.750714 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:23:04.751269 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:23:04.751803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:04.753561 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:23:04.754099 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:23:04.754679 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:23:04.775100 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m03:23:04.777106 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:23:04.779239 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:23:04.779901 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:23:04.781311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2a23ee6c0>]}
[0m03:23:04.782214 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:04.782723 [debug] [MainThread]: On master: BEGIN
[0m03:23:04.783386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:23:04.784984 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:23:04.785552 [debug] [MainThread]: On master: COMMIT
[0m03:23:04.786096 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:04.786578 [debug] [MainThread]: On master: COMMIT
[0m03:23:04.788019 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:04.788644 [debug] [MainThread]: On master: Close
[0m03:23:04.795974 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:23:04.797103 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:23:04.798175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:23:04.798802 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:23:04.815165 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:23:04.816494 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:23:04.868269 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:23:04.869518 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:23:04.870255 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:23:04.870820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:23:04.872761 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:23:04.873555 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:23:04.874207 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:23:04.875758 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:23:04.876500 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:23:04.877251 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:23:04.883770 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:23:04.884409 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:23:04.887962 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:23:04.890462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07d023d9-0c67-4ec3-976e-86d78ff89d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ade2f560>]}
[0m03:23:04.891571 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.09s]
[0m03:23:04.892686 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:23:04.893799 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:23:04.896735 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:23:04.898445 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:23:04.899336 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:23:04.903119 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:04.903669 [debug] [MainThread]: On master: BEGIN
[0m03:23:04.904466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:23:04.906021 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:23:04.906556 [debug] [MainThread]: On master: COMMIT
[0m03:23:04.907037 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:04.907493 [debug] [MainThread]: On master: COMMIT
[0m03:23:04.909038 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:04.909567 [debug] [MainThread]: On master: Close
[0m03:23:04.910177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:23:04.910721 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:23:04.911349 [info ] [MainThread]: 
[0m03:23:04.912152 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m03:23:04.913515 [debug] [MainThread]: Command end result
[0m03:23:04.948908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:23:04.951548 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:23:04.961101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:23:04.961735 [info ] [MainThread]: 
[0m03:23:04.962684 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:23:04.963372 [info ] [MainThread]: 
[0m03:23:04.964214 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:23:04.965001 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:23:04.965581 [info ] [MainThread]: 
[0m03:23:04.966258 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:23:04.966909 [info ] [MainThread]: 
[0m03:23:04.967609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:23:04.969463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6152875, "process_in_blocks": "0", "process_kernel_time": 0.727413, "process_mem_max_rss": "153012", "process_out_blocks": "2168", "process_user_time": 3.621505}
[0m03:23:04.970181 [debug] [MainThread]: Command `dbt run` failed at 03:23:04.970024 after 1.62 seconds
[0m03:23:04.970837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ae85e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2ae85d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb2a00b6660>]}
[0m03:23:04.971430 [debug] [MainThread]: Flushing usage events
[0m03:23:05.841805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:23:24.651599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7bf74fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7db3ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7ce495e0>]}


============================== 03:23:24.658139 | 3450ed18-0014-48e5-b055-f37917f4478d ==============================
[0m03:23:24.658139 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:23:24.659157 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs'}
[0m03:23:25.112461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7da64f80>]}
[0m03:23:25.230183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b6f406180>]}
[0m03:23:25.233319 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:23:25.403375 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:23:25.592570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:23:25.593324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:23:25.662206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7b09baa0>]}
[0m03:23:25.793082 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:23:25.796495 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:23:25.820002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b6d124ce0>]}
[0m03:23:25.820884 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:23:25.821575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7b049310>]}
[0m03:23:25.825192 [info ] [MainThread]: 
[0m03:23:25.825996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:23:25.826635 [info ] [MainThread]: 
[0m03:23:25.827718 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:23:25.836267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:23:25.914569 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:23:25.915501 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:23:25.916281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:25.948957 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m03:23:25.951623 [debug] [ThreadPool]: On list_medallion: Close
[0m03:23:25.953157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:23:25.954013 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:23:25.966711 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:25.967567 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:23:25.968125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:25.972015 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:23:25.975055 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:25.976207 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:23:25.978321 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:25.979032 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:25.979536 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:23:25.980991 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:25.982788 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:23:25.983515 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:25.984002 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:23:25.986010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:25.986609 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:23:25.989254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:23:25.999917 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:23:26.001135 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:23:26.001803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:26.004608 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:23:26.005257 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:23:26.005833 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:23:26.030713 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m03:23:26.033203 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:23:26.035580 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:23:26.036537 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:23:26.038288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b6f424f20>]}
[0m03:23:26.039176 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:26.039698 [debug] [MainThread]: On master: BEGIN
[0m03:23:26.040360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:23:26.041968 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:23:26.042589 [debug] [MainThread]: On master: COMMIT
[0m03:23:26.043135 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:26.043683 [debug] [MainThread]: On master: COMMIT
[0m03:23:26.046064 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:23:26.046904 [debug] [MainThread]: On master: Close
[0m03:23:26.054983 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:23:26.056285 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:23:26.057187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:23:26.057870 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:23:26.075654 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:23:26.077362 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:23:26.133590 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:23:26.135101 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:23:26.135807 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:23:26.136443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:23:26.138697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:23:26.139377 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:23:26.139969 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:23:26.141605 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:23:26.142488 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:23:26.143258 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:23:26.150401 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:23:26.151079 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:23:26.154802 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:23:26.157493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3450ed18-0014-48e5-b055-f37917f4478d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7c0c23f0>]}
[0m03:23:26.158650 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.10s]
[0m03:23:26.159734 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:23:26.160903 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:23:26.164434 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:23:26.165287 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:23:26.166335 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:23:26.170539 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:26.171161 [debug] [MainThread]: On master: BEGIN
[0m03:23:26.171728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:23:26.173280 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:26.173968 [debug] [MainThread]: On master: COMMIT
[0m03:23:26.174556 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:26.175123 [debug] [MainThread]: On master: COMMIT
[0m03:23:26.176372 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:26.176940 [debug] [MainThread]: On master: Close
[0m03:23:26.177871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:23:26.178509 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:23:26.179037 [info ] [MainThread]: 
[0m03:23:26.179722 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:23:26.181261 [debug] [MainThread]: Command end result
[0m03:23:26.219416 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:23:26.222579 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:23:26.232798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:23:26.233440 [info ] [MainThread]: 
[0m03:23:26.234217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:23:26.234870 [info ] [MainThread]: 
[0m03:23:26.235878 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:23:26.236744 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:23:26.237389 [info ] [MainThread]: 
[0m03:23:26.238170 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:23:26.238800 [info ] [MainThread]: 
[0m03:23:26.239580 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:23:26.241503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7195594, "process_in_blocks": "0", "process_kernel_time": 0.856556, "process_mem_max_rss": "152608", "process_out_blocks": "2168", "process_user_time": 3.77505}
[0m03:23:26.242332 [debug] [MainThread]: Command `dbt run` failed at 03:23:26.242170 after 1.72 seconds
[0m03:23:26.242937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b7b31f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b6d38d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3b6d38fc50>]}
[0m03:23:26.243573 [debug] [MainThread]: Flushing usage events
[0m03:23:27.148073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:23:44.925149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07fa31040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07f74d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07ff959d0>]}


============================== 03:23:44.932256 | b8ba854a-cbe1-4bbf-a20a-a2c522361286 ==============================
[0m03:23:44.932256 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:23:44.933352 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'fail_fast': 'False', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt'}
[0m03:23:45.381246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc081a790d0>]}
[0m03:23:45.500662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc08195c080>]}
[0m03:23:45.503898 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:23:45.695131 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:23:45.905487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:23:45.906391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:23:45.980375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07355bc80>]}
[0m03:23:46.116292 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:23:46.120019 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:23:46.143579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc071140ef0>]}
[0m03:23:46.144486 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:23:46.145164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07f213170>]}
[0m03:23:46.148761 [info ] [MainThread]: 
[0m03:23:46.149533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:23:46.150569 [info ] [MainThread]: 
[0m03:23:46.151892 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:23:46.160482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:23:46.239027 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:23:46.239830 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:23:46.240432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:46.270843 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m03:23:46.273470 [debug] [ThreadPool]: On list_medallion: Close
[0m03:23:46.275175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:23:46.275958 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:23:46.288576 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:46.289598 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:23:46.290290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:46.293743 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:23:46.296096 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:46.296686 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:23:46.298096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:46.298637 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:46.299117 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:23:46.300446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:46.301930 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:23:46.302597 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:23:46.303084 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:23:46.304186 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:46.304731 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:23:46.307589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:23:46.317201 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:23:46.317945 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:23:46.318422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:46.320096 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:23:46.320781 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:23:46.321351 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:23:46.343868 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m03:23:46.346296 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:23:46.348435 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:23:46.348994 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:23:46.350410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07132b2c0>]}
[0m03:23:46.351236 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:46.351743 [debug] [MainThread]: On master: BEGIN
[0m03:23:46.352374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:23:46.354086 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:23:46.354640 [debug] [MainThread]: On master: COMMIT
[0m03:23:46.355137 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:46.355648 [debug] [MainThread]: On master: COMMIT
[0m03:23:46.357440 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:46.358084 [debug] [MainThread]: On master: Close
[0m03:23:46.367650 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:23:46.368880 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:23:46.369877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:23:46.370492 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:23:46.387827 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:23:46.389016 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:23:46.444021 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:23:46.445427 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:23:46.446313 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:23:46.446958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:23:46.449927 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:23:46.450637 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:23:46.451392 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:23:46.452885 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:23:46.453603 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:23:46.454588 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:23:46.461365 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:23:46.462188 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:23:46.465794 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:23:46.468516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ba854a-cbe1-4bbf-a20a-a2c522361286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc0735c3ad0>]}
[0m03:23:46.469550 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.10s]
[0m03:23:46.470761 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:23:46.471764 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:23:46.475153 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:23:46.476048 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:23:46.476900 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:23:46.480739 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:46.481306 [debug] [MainThread]: On master: BEGIN
[0m03:23:46.482139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:23:46.483817 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:23:46.484364 [debug] [MainThread]: On master: COMMIT
[0m03:23:46.484894 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:46.485562 [debug] [MainThread]: On master: COMMIT
[0m03:23:46.487050 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:46.487614 [debug] [MainThread]: On master: Close
[0m03:23:46.488341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:23:46.488993 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:23:46.489735 [info ] [MainThread]: 
[0m03:23:46.490622 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m03:23:46.491930 [debug] [MainThread]: Command end result
[0m03:23:46.531236 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:23:46.534346 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:23:46.544931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:23:46.545801 [info ] [MainThread]: 
[0m03:23:46.546619 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:23:46.547287 [info ] [MainThread]: 
[0m03:23:46.548033 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:23:46.548802 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:23:46.549386 [info ] [MainThread]: 
[0m03:23:46.550187 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:23:46.550878 [info ] [MainThread]: 
[0m03:23:46.551576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:23:46.553532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.741914, "process_in_blocks": "0", "process_kernel_time": 0.72172, "process_mem_max_rss": "153112", "process_out_blocks": "2176", "process_user_time": 3.895739}
[0m03:23:46.554730 [debug] [MainThread]: Command `dbt run` failed at 03:23:46.554536 after 1.74 seconds
[0m03:23:46.555396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07f9dd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07f213110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc07f212ed0>]}
[0m03:23:46.556114 [debug] [MainThread]: Flushing usage events
[0m03:23:47.398997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:24:06.483372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe09c43c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe0959b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe08705d30>]}


============================== 03:24:06.498889 | 6dae2aef-35d8-4b6d-8785-ff815f99d53e ==============================
[0m03:24:06.498889 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:24:06.500298 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True'}
[0m03:24:07.209100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe08064830>]}
[0m03:24:07.341926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe09c43c50>]}
[0m03:24:07.345306 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:24:07.517529 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:24:07.712239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:07.712913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:07.780246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfdf9534080>]}
[0m03:24:07.918805 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:24:07.922763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:24:07.954232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfdf9345040>]}
[0m03:24:07.955132 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:24:07.955935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfdfb75cce0>]}
[0m03:24:07.959307 [info ] [MainThread]: 
[0m03:24:07.960050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:24:07.960650 [info ] [MainThread]: 
[0m03:24:07.961658 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:24:07.969634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:24:08.087402 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:24:08.088322 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:24:08.089490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:08.132594 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m03:24:08.135230 [debug] [ThreadPool]: On list_medallion: Close
[0m03:24:08.136860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:24:08.137621 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:24:08.149253 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:08.149938 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:24:08.150426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:08.153711 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:24:08.156438 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:08.157044 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:24:08.158656 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:24:08.159182 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:08.159807 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:24:08.161735 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:24:08.163201 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:24:08.163948 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:08.164467 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:24:08.165745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:24:08.166291 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:24:08.169181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:24:08.179099 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:24:08.179910 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:24:08.180391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:08.182281 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:24:08.182915 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:24:08.183425 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:24:08.209150 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m03:24:08.211436 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:24:08.214168 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:24:08.214962 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:24:08.216431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfdf9330b90>]}
[0m03:24:08.217360 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:08.217890 [debug] [MainThread]: On master: BEGIN
[0m03:24:08.218353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:24:08.219970 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:24:08.220630 [debug] [MainThread]: On master: COMMIT
[0m03:24:08.221299 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:08.221888 [debug] [MainThread]: On master: COMMIT
[0m03:24:08.223781 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:24:08.224460 [debug] [MainThread]: On master: Close
[0m03:24:08.233970 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:24:08.235036 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:24:08.236126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:24:08.236993 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:24:08.253786 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:24:08.257111 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:24:08.311486 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:24:08.313088 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:24:08.313806 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:24:08.314362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:08.318109 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m03:24:08.318816 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:24:08.319503 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:24:08.323501 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:24:08.324314 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:24:08.325137 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:24:08.335568 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:24:08.336343 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:24:08.340024 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:24:08.342726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dae2aef-35d8-4b6d-8785-ff815f99d53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfdfb624680>]}
[0m03:24:08.343858 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.10s]
[0m03:24:08.345134 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:24:08.346181 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:24:08.349300 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:24:08.350116 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:24:08.350981 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:24:08.355020 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:08.355774 [debug] [MainThread]: On master: BEGIN
[0m03:24:08.356420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:24:08.357884 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:24:08.358436 [debug] [MainThread]: On master: COMMIT
[0m03:24:08.358929 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:08.359385 [debug] [MainThread]: On master: COMMIT
[0m03:24:08.361134 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:24:08.361799 [debug] [MainThread]: On master: Close
[0m03:24:08.362524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:08.363059 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:24:08.363635 [info ] [MainThread]: 
[0m03:24:08.364362 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m03:24:08.365622 [debug] [MainThread]: Command end result
[0m03:24:08.424553 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:24:08.428698 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:24:08.440465 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:24:08.441272 [info ] [MainThread]: 
[0m03:24:08.442063 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:24:08.442784 [info ] [MainThread]: 
[0m03:24:08.443706 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:24:08.444522 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:24:08.445163 [info ] [MainThread]: 
[0m03:24:08.445864 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:24:08.446451 [info ] [MainThread]: 
[0m03:24:08.447135 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:24:08.448961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.142569, "process_in_blocks": "0", "process_kernel_time": 1.279987, "process_mem_max_rss": "152848", "process_out_blocks": "2184", "process_user_time": 4.952658}
[0m03:24:08.449799 [debug] [MainThread]: Command `dbt run` failed at 03:24:08.449631 after 2.14 seconds
[0m03:24:08.450491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe07ce1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe07353380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfdf8811160>]}
[0m03:24:08.451105 [debug] [MainThread]: Flushing usage events
[0m03:24:09.172922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:24:27.322916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c54619a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c542c6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c53f8a7e0>]}


============================== 03:24:27.329835 | 2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd ==============================
[0m03:24:27.329835 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:24:27.330956 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False'}
[0m03:24:27.783111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c535139e0>]}
[0m03:24:27.903019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c54a694f0>]}
[0m03:24:27.906430 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:24:28.080340 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:24:28.275268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:28.276008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:28.348129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c45817d40>]}
[0m03:24:28.483512 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:24:28.486720 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:24:28.512827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c457fc620>]}
[0m03:24:28.513719 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:24:28.514432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c457e4ce0>]}
[0m03:24:28.517697 [info ] [MainThread]: 
[0m03:24:28.518509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:24:28.519138 [info ] [MainThread]: 
[0m03:24:28.520179 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:24:28.529554 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:24:28.617023 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:24:28.617766 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:24:28.618336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:28.653454 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m03:24:28.656214 [debug] [ThreadPool]: On list_medallion: Close
[0m03:24:28.657693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:24:28.658526 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:24:28.670249 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:28.670940 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:24:28.671436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:28.674709 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:24:28.677166 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:28.677810 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:24:28.679437 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:24:28.680145 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:28.680637 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:24:28.682220 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:24:28.683553 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:24:28.684243 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:24:28.684719 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:24:28.686394 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:24:28.686997 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:24:28.689864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:24:28.699648 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:24:28.700502 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:24:28.701058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:28.702646 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:24:28.703296 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:24:28.703903 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:24:28.725711 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m03:24:28.728174 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:24:28.730173 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:24:28.730734 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:24:28.732244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c53614170>]}
[0m03:24:28.733047 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:28.733590 [debug] [MainThread]: On master: BEGIN
[0m03:24:28.734174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:24:28.736217 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:24:28.736997 [debug] [MainThread]: On master: COMMIT
[0m03:24:28.737709 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:28.738328 [debug] [MainThread]: On master: COMMIT
[0m03:24:28.740387 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:24:28.741041 [debug] [MainThread]: On master: Close
[0m03:24:28.748714 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:24:28.749813 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:24:28.750862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:24:28.751500 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:24:28.768611 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:24:28.771086 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:24:28.825206 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:24:28.826506 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:24:28.827186 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:24:28.827759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:28.829620 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:24:28.830241 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:24:28.830836 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:24:28.832408 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:24:28.833128 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:24:28.833957 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:24:28.840587 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:24:28.841357 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:24:28.844941 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:24:28.847526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2191e60d-ff31-4f78-97fa-5ad0eeb3c8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c1c11f440>]}
[0m03:24:28.848687 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.09s]
[0m03:24:28.849820 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:24:28.850855 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:24:28.854013 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:24:28.854890 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:24:28.856047 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:24:28.860111 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:28.860687 [debug] [MainThread]: On master: BEGIN
[0m03:24:28.861268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:24:28.862957 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:24:28.863523 [debug] [MainThread]: On master: COMMIT
[0m03:24:28.864225 [debug] [MainThread]: Using duckdb connection "master"
[0m03:24:28.864849 [debug] [MainThread]: On master: COMMIT
[0m03:24:28.866181 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:24:28.866842 [debug] [MainThread]: On master: Close
[0m03:24:28.867616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:28.868278 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:24:28.868794 [info ] [MainThread]: 
[0m03:24:28.869434 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:24:28.870812 [debug] [MainThread]: Command end result
[0m03:24:28.910093 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:24:28.913351 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:24:28.923686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:24:28.924384 [info ] [MainThread]: 
[0m03:24:28.925152 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:24:28.925925 [info ] [MainThread]: 
[0m03:24:28.926762 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:24:28.927546 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:24:28.928187 [info ] [MainThread]: 
[0m03:24:28.928940 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:24:28.929571 [info ] [MainThread]: 
[0m03:24:28.930233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:24:28.932038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7173936, "process_in_blocks": "0", "process_kernel_time": 0.84443, "process_mem_max_rss": "152836", "process_out_blocks": "2176", "process_user_time": 3.65401}
[0m03:24:28.932914 [debug] [MainThread]: Command `dbt run` failed at 03:24:28.932744 after 1.72 seconds
[0m03:24:28.933538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c53764b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c457fcda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747c53ec4b30>]}
[0m03:24:28.934213 [debug] [MainThread]: Flushing usage events
[0m03:24:29.645463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:44.945188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35c1b92de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35c2591160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35c2aecec0>]}


============================== 03:25:44.966633 | 4192e48c-62af-43d9-b252-ac58d3ff0a15 ==============================
[0m03:25:44.966633 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:25:44.968922 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'no_print': 'None', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles'}
[0m03:25:45.972421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35c29789e0>]}
[0m03:25:46.115782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35c1d30230>]}
[0m03:25:46.122279 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:25:46.359425 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:25:46.636529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:25:46.637252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:25:46.709397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3583e39550>]}
[0m03:25:46.875733 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:25:46.879444 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:25:46.929261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35b5f35e50>]}
[0m03:25:46.930740 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m03:25:46.931696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3583e822d0>]}
[0m03:25:46.937021 [info ] [MainThread]: 
[0m03:25:46.938457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:25:46.939475 [info ] [MainThread]: 
[0m03:25:46.941055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:25:46.953909 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:25:47.140202 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:25:47.140970 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:25:47.141731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:47.224707 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m03:25:47.229522 [debug] [ThreadPool]: On list_medallion: Close
[0m03:25:47.231317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:25:47.233704 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:25:47.246336 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:25:47.247113 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:25:47.247696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:47.251197 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:25:47.254128 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:25:47.255072 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:25:47.257908 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:25:47.258908 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:25:47.259780 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:25:47.263546 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:25:47.266374 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:25:47.267489 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:25:47.268356 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:25:47.271264 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:25:47.272215 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:25:47.277630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:25:47.292378 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:25:47.294408 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:25:47.295656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:47.298112 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:25:47.298866 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:25:47.299782 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:25:47.355886 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m03:25:47.358959 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:25:47.363318 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:25:47.363983 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:25:47.365349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35b5f36540>]}
[0m03:25:47.366338 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:47.366980 [debug] [MainThread]: On master: BEGIN
[0m03:25:47.367570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:47.369471 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:25:47.370193 [debug] [MainThread]: On master: COMMIT
[0m03:25:47.370713 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:47.371283 [debug] [MainThread]: On master: COMMIT
[0m03:25:47.372825 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:25:47.373410 [debug] [MainThread]: On master: Close
[0m03:25:47.386079 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:25:47.387871 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:25:47.389358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:25:47.390360 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:25:47.407739 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:25:47.412430 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:25:47.467649 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:25:47.470085 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:25:47.470820 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:25:47.471411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:47.473290 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:25:47.473961 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:25:47.474636 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:25:47.489092 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m03:25:47.489844 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:25:47.490766 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:25:47.506441 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:25:47.507191 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:25:47.510944 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:25:47.514368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4192e48c-62af-43d9-b252-ac58d3ff0a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35830792e0>]}
[0m03:25:47.515584 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.12s]
[0m03:25:47.517089 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:25:47.518269 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m03:25:47.520987 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:25:47.523087 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:25:47.524109 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:25:47.528324 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:47.528884 [debug] [MainThread]: On master: BEGIN
[0m03:25:47.529504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:47.531138 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:25:47.531788 [debug] [MainThread]: On master: COMMIT
[0m03:25:47.532338 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:47.532840 [debug] [MainThread]: On master: COMMIT
[0m03:25:47.534240 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:25:47.534943 [debug] [MainThread]: On master: Close
[0m03:25:47.535718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:47.536323 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:25:47.536828 [info ] [MainThread]: 
[0m03:25:47.537597 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m03:25:47.539094 [debug] [MainThread]: Command end result
[0m03:25:47.578490 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m03:25:47.581584 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m03:25:47.592556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m03:25:47.593298 [info ] [MainThread]: 
[0m03:25:47.594250 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:25:47.594949 [info ] [MainThread]: 
[0m03:25:47.595999 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:25:47.596972 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m03:25:47.597637 [info ] [MainThread]: 
[0m03:25:47.598399 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:25:47.598989 [info ] [MainThread]: 
[0m03:25:47.599787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:25:47.602954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8334863, "process_in_blocks": "0", "process_kernel_time": 2.299201, "process_mem_max_rss": "152804", "process_out_blocks": "2176", "process_user_time": 5.172226}
[0m03:25:47.603859 [debug] [MainThread]: Command `dbt run` failed at 03:25:47.603670 after 2.84 seconds
[0m03:25:47.604495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a35c4775610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3583e39430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3583e388c0>]}
[0m03:25:47.605091 [debug] [MainThread]: Flushing usage events
[0m03:25:48.606232 [debug] [MainThread]: An error was encountered while trying to flush usage events
