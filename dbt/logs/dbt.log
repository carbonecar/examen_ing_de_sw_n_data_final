[0m02:05:31.254482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618179bacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761817007380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761816d59130>]}


============================== 02:05:31.293783 | 34c0d9cf-780f-4044-a7ab-c3c130cab089 ==============================
[0m02:05:31.293783 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:05:31.295631 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True'}
[0m02:05:31.110700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761816724b30>]}
[0m02:05:31.408842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761818fa4170>]}
[0m02:05:31.421701 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:05:31.785955 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:05:32.371309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:05:32.373459 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m02:05:34.059598 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m02:05:34.062649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618166b2e40>]}
[0m02:05:34.327039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a5a78c0>]}
[0m02:05:34.677494 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:05:34.683737 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:05:35.234722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a6187d0>]}
[0m02:05:35.236175 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m02:05:35.242312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a64c560>]}
[0m02:05:35.254896 [info ] [MainThread]: 
[0m02:05:35.257021 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:05:35.258231 [info ] [MainThread]: 
[0m02:05:35.259819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:05:35.272696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m02:05:35.510475 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m02:05:35.513276 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m02:05:35.514706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:35.639779 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m02:05:35.644843 [debug] [ThreadPool]: On list_medallion: Close
[0m02:05:35.646897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m02:05:35.648180 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m02:05:35.668636 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.670745 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m02:05:35.672100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:35.680240 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m02:05:35.687412 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.688517 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m02:05:35.691836 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:05:35.693202 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.694481 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m02:05:35.700190 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:05:35.705706 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:05:35.708585 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:05:35.710109 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:05:35.716868 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:05:35.719107 [debug] [ThreadPool]: On create_medallion_main: Close
[0m02:05:35.727950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m02:05:35.749976 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:05:35.751358 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m02:05:35.752005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:35.755046 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:05:35.756118 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:05:35.758741 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m02:05:35.840540 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m02:05:35.847962 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m02:05:35.863486 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m02:05:35.866967 [debug] [ThreadPool]: On list_medallion_main: Close
[0m02:05:35.870675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a604a70>]}
[0m02:05:35.872494 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:35.873216 [debug] [MainThread]: On master: BEGIN
[0m02:05:35.873756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:05:35.876412 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m02:05:35.877189 [debug] [MainThread]: On master: COMMIT
[0m02:05:35.878032 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:35.878637 [debug] [MainThread]: On master: COMMIT
[0m02:05:35.881271 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:05:35.889443 [debug] [MainThread]: On master: Close
[0m02:05:35.919600 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m02:05:35.921455 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m02:05:35.922901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m02:05:35.923668 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m02:05:35.966603 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m02:05:35.971731 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m02:05:36.130318 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m02:05:36.133173 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:05:36.134749 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m02:05:36.136013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:36.139563 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:05:36.141923 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:05:36.144267 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:05:36.189744 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:05:36.192623 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:05:36.194775 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m02:05:36.235243 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m02:05:36.236577 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m02:05:36.243485 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:05:36.255184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34c0d9cf-780f-4044-a7ab-c3c130cab089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180a679940>]}
[0m02:05:36.258658 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.32s]
[0m02:05:36.260995 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m02:05:36.262487 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m02:05:36.267674 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m02:05:36.269882 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m02:05:36.271331 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m02:05:36.280291 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:36.282932 [debug] [MainThread]: On master: BEGIN
[0m02:05:36.284723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:36.290863 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m02:05:36.292256 [debug] [MainThread]: On master: COMMIT
[0m02:05:36.293733 [debug] [MainThread]: Using duckdb connection "master"
[0m02:05:36.295670 [debug] [MainThread]: On master: COMMIT
[0m02:05:36.304603 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m02:05:36.314472 [debug] [MainThread]: On master: Close
[0m02:05:36.318098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:36.319433 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m02:05:36.320555 [info ] [MainThread]: 
[0m02:05:36.321995 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m02:05:36.325304 [debug] [MainThread]: Command end result
[0m02:05:36.416471 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:05:36.428915 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:05:36.451436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m02:05:36.452510 [info ] [MainThread]: 
[0m02:05:36.453467 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:05:36.454355 [info ] [MainThread]: 
[0m02:05:36.455191 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m02:05:36.455976 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:05:36.456692 [info ] [MainThread]: 
[0m02:05:36.457447 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m02:05:36.458467 [info ] [MainThread]: 
[0m02:05:36.460664 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m02:05:36.463059 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:05:36.469605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.169751, "process_in_blocks": "328", "process_kernel_time": 6.389547, "process_mem_max_rss": "154568", "process_out_blocks": "3200", "process_user_time": 15.360568}
[0m02:05:36.471867 [debug] [MainThread]: Command `dbt run` failed at 02:05:36.471427 after 8.17 seconds
[0m02:05:36.473882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618176cd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7618168478f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76180838edb0>]}
[0m02:05:36.475663 [debug] [MainThread]: Flushing usage events
[0m02:05:37.680219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:17.773055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce26a2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce1261c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce1263560>]}


============================== 01:26:17.785532 | f45d8407-9bdf-4d77-915e-b992a00d425c ==============================
[0m01:26:17.785532 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:26:17.786710 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None'}
[0m01:26:18.901620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce1746750>]}
[0m01:26:19.039411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce0d505c0>]}
[0m01:26:19.045555 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:26:19.276057 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:26:19.612202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:26:19.614121 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m01:26:20.617052 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m01:26:20.618269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cd4d27d40>]}
[0m01:26:20.798018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c96a4e900>]}
[0m01:26:21.005249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:26:21.013438 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:26:21.244277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c9695f290>]}
[0m01:26:21.245376 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m01:26:21.246154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c968f7ce0>]}
[0m01:26:21.251408 [info ] [MainThread]: 
[0m01:26:21.252494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:26:21.253256 [info ] [MainThread]: 
[0m01:26:21.254425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:26:21.267401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m01:26:21.385425 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m01:26:21.386223 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m01:26:21.387004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:21.473545 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m01:26:21.477100 [debug] [ThreadPool]: On list_medallion: Close
[0m01:26:21.479053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m01:26:21.480237 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m01:26:21.493861 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:26:21.494699 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m01:26:21.495507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:21.499932 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:26:21.502523 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:26:21.503268 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m01:26:21.504568 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:26:21.505302 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:26:21.505911 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m01:26:21.507802 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:26:21.509496 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:26:21.510101 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:26:21.510601 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:26:21.512086 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:26:21.512661 [debug] [ThreadPool]: On create_medallion_main: Close
[0m01:26:21.519174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m01:26:21.536921 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:26:21.537803 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m01:26:21.538587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:21.540776 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:26:21.541478 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:26:21.542090 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m01:26:21.572657 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m01:26:21.575569 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m01:26:21.579657 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m01:26:21.580522 [debug] [ThreadPool]: On list_medallion_main: Close
[0m01:26:21.582123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce31cc8c0>]}
[0m01:26:21.583120 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:21.583750 [debug] [MainThread]: On master: BEGIN
[0m01:26:21.584258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:21.586337 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:26:21.587217 [debug] [MainThread]: On master: COMMIT
[0m01:26:21.587819 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:21.588434 [debug] [MainThread]: On master: COMMIT
[0m01:26:21.590255 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:26:21.591215 [debug] [MainThread]: On master: Close
[0m01:26:21.614075 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m01:26:21.615807 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m01:26:21.616911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m01:26:21.617676 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m01:26:21.641756 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m01:26:21.644974 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m01:26:21.714961 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m01:26:21.717681 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:26:21.718589 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m01:26:21.719419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:21.721486 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:26:21.722230 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:26:21.722917 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m01:26:21.746788 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m01:26:21.747881 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:26:21.748778 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m01:26:21.768541 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m01:26:21.769461 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m01:26:21.774722 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m01:26:21.782003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f45d8407-9bdf-4d77-915e-b992a00d425c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce18d67b0>]}
[0m01:26:21.783667 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.16s]
[0m01:26:21.784880 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m01:26:21.786135 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m01:26:21.789851 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m01:26:21.791927 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m01:26:21.793372 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m01:26:21.798125 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:21.799170 [debug] [MainThread]: On master: BEGIN
[0m01:26:21.799903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:21.801950 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:26:21.802892 [debug] [MainThread]: On master: COMMIT
[0m01:26:21.803681 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:21.804460 [debug] [MainThread]: On master: COMMIT
[0m01:26:21.806199 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:26:21.807342 [debug] [MainThread]: On master: Close
[0m01:26:21.808571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:21.809182 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m01:26:21.813698 [info ] [MainThread]: 
[0m01:26:21.814779 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m01:26:21.816380 [debug] [MainThread]: Command end result
[0m01:26:21.869628 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:26:21.873236 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:26:21.884127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m01:26:21.884877 [info ] [MainThread]: 
[0m01:26:21.885706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:26:21.886508 [info ] [MainThread]: 
[0m01:26:21.887467 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m01:26:21.888278 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m01:26:21.889091 [info ] [MainThread]: 
[0m01:26:21.889863 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m01:26:21.890622 [info ] [MainThread]: 
[0m01:26:21.891430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m01:26:21.892638 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:26:21.894650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.274797, "process_in_blocks": "109336", "process_kernel_time": 1.931797, "process_mem_max_rss": "154620", "process_out_blocks": "3184", "process_user_time": 6.461247}
[0m01:26:21.895556 [debug] [MainThread]: Command `dbt run` failed at 01:26:21.895368 after 4.28 seconds
[0m01:26:21.896236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce0f712e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce1797440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9ce1795b20>]}
[0m01:26:21.896913 [debug] [MainThread]: Flushing usage events
[0m01:26:23.588689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:40.019579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115ce2b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115ccb5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115e87bdd0>]}


============================== 01:29:40.034720 | 71acafbb-db4c-4d9d-92dc-625f0306d417 ==============================
[0m01:29:40.034720 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:29:40.036077 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:29:40.943412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115cb9c560>]}
[0m01:29:41.105854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115c9663f0>]}
[0m01:29:41.112188 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:29:41.326632 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:29:41.700240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:29:41.702697 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m01:29:42.685032 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m01:29:42.686659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115cde0bf0>]}
[0m01:29:42.811403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74114a13cb90>]}
[0m01:29:43.034918 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:29:43.041308 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:29:43.373769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741149e33140>]}
[0m01:29:43.376150 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m01:29:43.378500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741149c6aab0>]}
[0m01:29:43.386666 [info ] [MainThread]: 
[0m01:29:43.389544 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:29:43.391032 [info ] [MainThread]: 
[0m01:29:43.394759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:29:43.414341 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m01:29:43.560061 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m01:29:43.561021 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m01:29:43.561663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:43.641961 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m01:29:43.645092 [debug] [ThreadPool]: On list_medallion: Close
[0m01:29:43.647370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m01:29:43.649357 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m01:29:43.666508 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:29:43.667398 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m01:29:43.668059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:29:43.673094 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m01:29:43.676163 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:29:43.676859 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m01:29:43.678529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:29:43.679314 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:29:43.679840 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m01:29:43.681415 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:29:43.683136 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:29:43.683726 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m01:29:43.684317 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m01:29:43.685846 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:29:43.686604 [debug] [ThreadPool]: On create_medallion_main: Close
[0m01:29:43.690570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m01:29:43.707868 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:29:43.708790 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m01:29:43.709374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:29:43.711723 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:29:43.712494 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m01:29:43.713574 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m01:29:43.745538 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m01:29:43.748422 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m01:29:43.752369 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m01:29:43.753041 [debug] [ThreadPool]: On list_medallion_main: Close
[0m01:29:43.754571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7411493ee690>]}
[0m01:29:43.755848 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:43.756637 [debug] [MainThread]: On master: BEGIN
[0m01:29:43.757450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:43.759243 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:29:43.759868 [debug] [MainThread]: On master: COMMIT
[0m01:29:43.760479 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:43.761008 [debug] [MainThread]: On master: COMMIT
[0m01:29:43.763711 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:29:43.766115 [debug] [MainThread]: On master: Close
[0m01:29:43.784967 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m01:29:43.786250 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m01:29:43.787430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m01:29:43.788160 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m01:29:43.807924 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m01:29:43.810688 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m01:29:43.871137 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m01:29:43.873288 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:29:43.874241 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m01:29:43.875034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:29:43.877579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:29:43.878339 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m01:29:43.879192 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251211_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m01:29:43.902707 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251211_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m01:29:43.903821 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:29:43.904749 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m01:29:43.927068 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m01:29:43.928068 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m01:29:43.933758 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m01:29:43.938521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71acafbb-db4c-4d9d-92dc-625f0306d417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741149e21070>]}
[0m01:29:43.940535 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.15s]
[0m01:29:43.942545 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m01:29:43.944170 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m01:29:43.947975 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m01:29:43.948878 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m01:29:43.949742 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m01:29:43.954271 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:43.955225 [debug] [MainThread]: On master: BEGIN
[0m01:29:43.955777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:43.957650 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:29:43.958412 [debug] [MainThread]: On master: COMMIT
[0m01:29:43.959347 [debug] [MainThread]: Using duckdb connection "master"
[0m01:29:43.959884 [debug] [MainThread]: On master: COMMIT
[0m01:29:43.961594 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:29:43.962688 [debug] [MainThread]: On master: Close
[0m01:29:43.963976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:43.964708 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m01:29:43.965823 [info ] [MainThread]: 
[0m01:29:43.967940 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m01:29:43.969347 [debug] [MainThread]: Command end result
[0m01:29:44.036355 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m01:29:44.041252 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m01:29:44.051751 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m01:29:44.052490 [info ] [MainThread]: 
[0m01:29:44.053278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:29:44.054025 [info ] [MainThread]: 
[0m01:29:44.054989 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m01:29:44.055784 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m01:29:44.056512 [info ] [MainThread]: 
[0m01:29:44.057257 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m01:29:44.057932 [info ] [MainThread]: 
[0m01:29:44.058655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m01:29:44.059690 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:29:44.061605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.183653, "process_in_blocks": "109392", "process_kernel_time": 1.847436, "process_mem_max_rss": "154924", "process_out_blocks": "3192", "process_user_time": 6.273252}
[0m01:29:44.062499 [debug] [MainThread]: Command `dbt run` failed at 01:29:44.062325 after 4.18 seconds
[0m01:29:44.063255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741149d4c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115c026090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74115c71b350>]}
[0m01:29:44.063886 [debug] [MainThread]: Flushing usage events
[0m01:29:47.170918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:23:35.566056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6803a5d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6802cb5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6802627020>]}


============================== 02:23:35.592330 | c0ce636f-f363-4a00-800b-63b004ca4e4b ==============================
[0m02:23:35.592330 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:23:35.593958 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'indirect_selection': 'eager', 'fail_fast': 'False', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt'}
[0m02:23:37.116496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6804689490>]}
[0m02:23:37.313104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6802f00bc0>]}
[0m02:23:37.319641 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:23:37.619334 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:23:37.953407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:23:37.955289 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m02:23:39.100280 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m02:23:39.102892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67b7c44500>]}
[0m02:23:39.323021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67b7cdbfe0>]}
[0m02:23:39.549115 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:23:39.558930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:23:39.874579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67b7d4f620>]}
[0m02:23:39.876029 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m02:23:39.877046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67b7d42540>]}
[0m02:23:39.881813 [info ] [MainThread]: 
[0m02:23:39.883504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:23:39.884500 [info ] [MainThread]: 
[0m02:23:39.885758 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:23:39.898310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m02:23:40.085141 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m02:23:40.086483 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m02:23:40.087283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:40.284298 [debug] [ThreadPool]: SQL status: OK in 0.197 seconds
[0m02:23:40.290795 [debug] [ThreadPool]: On list_medallion: Close
[0m02:23:40.293341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m02:23:40.294526 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m02:23:40.308670 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:23:40.309452 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m02:23:40.310768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:40.316743 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m02:23:40.319693 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:23:40.320387 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m02:23:40.323395 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:23:40.324356 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:23:40.324980 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m02:23:40.330373 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:23:40.333357 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:23:40.334252 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:23:40.335146 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:23:40.337296 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:23:40.338207 [debug] [ThreadPool]: On create_medallion_main: Close
[0m02:23:40.343190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m02:23:40.359206 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:23:40.360109 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m02:23:40.360660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:40.363026 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:23:40.363978 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:23:40.365373 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m02:23:40.435004 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m02:23:40.439748 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m02:23:40.444948 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m02:23:40.445859 [debug] [ThreadPool]: On list_medallion_main: Close
[0m02:23:40.450073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67b7ef3da0>]}
[0m02:23:40.451819 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:40.452806 [debug] [MainThread]: On master: BEGIN
[0m02:23:40.453537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:40.456473 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m02:23:40.457450 [debug] [MainThread]: On master: COMMIT
[0m02:23:40.458229 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:40.459350 [debug] [MainThread]: On master: COMMIT
[0m02:23:40.462130 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:23:40.463561 [debug] [MainThread]: On master: Close
[0m02:23:40.482484 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m02:23:40.484729 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m02:23:40.486161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m02:23:40.487357 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m02:23:40.513457 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m02:23:40.517639 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m02:23:40.604529 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m02:23:40.607266 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:23:40.608105 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m02:23:40.608816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:40.612212 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:23:40.613125 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:23:40.614102 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:23:40.659693 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:23:40.660888 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:23:40.662226 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m02:23:40.686668 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m02:23:40.688231 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m02:23:40.692888 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:23:40.697609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ce636f-f363-4a00-800b-63b004ca4e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67b7d6e390>]}
[0m02:23:40.700257 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.21s]
[0m02:23:40.703108 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m02:23:40.705622 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m02:23:40.710089 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m02:23:40.711768 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m02:23:40.712833 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m02:23:40.719409 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:40.720865 [debug] [MainThread]: On master: BEGIN
[0m02:23:40.721719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:40.724388 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m02:23:40.725106 [debug] [MainThread]: On master: COMMIT
[0m02:23:40.725681 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:40.726244 [debug] [MainThread]: On master: COMMIT
[0m02:23:40.728052 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:23:40.728791 [debug] [MainThread]: On master: Close
[0m02:23:40.729802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:40.730463 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m02:23:40.731507 [info ] [MainThread]: 
[0m02:23:40.732702 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m02:23:40.734728 [debug] [MainThread]: Command end result
[0m02:23:40.787404 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:23:40.791678 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:23:40.807606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m02:23:40.808600 [info ] [MainThread]: 
[0m02:23:40.809599 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:23:40.810540 [info ] [MainThread]: 
[0m02:23:40.811836 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m02:23:40.813112 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:23:40.814211 [info ] [MainThread]: 
[0m02:23:40.815429 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m02:23:40.816299 [info ] [MainThread]: 
[0m02:23:40.817269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m02:23:40.818629 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:23:40.821398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.4361773, "process_in_blocks": "0", "process_kernel_time": 3.198371, "process_mem_max_rss": "155400", "process_out_blocks": "3184", "process_user_time": 8.676689}
[0m02:23:40.822594 [debug] [MainThread]: Command `dbt run` failed at 02:23:40.822298 after 5.44 seconds
[0m02:23:40.823664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6801ed6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6802181880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6802182c60>]}
[0m02:23:40.824551 [debug] [MainThread]: Flushing usage events
[0m02:23:41.827313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:06.353695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9dd8ead20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9dcf13140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9dd19ba10>]}


============================== 02:34:06.380186 | 4c73591b-2d7d-4c85-a43a-afb5a18052b4 ==============================
[0m02:34:06.380186 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:34:06.383665 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/home/nilay/examen_ing_de_sw_n_data_final/profiles', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/home/nilay/examen_ing_de_sw_n_data_final/dbt/logs', 'invocation_command': 'dbt run --project-dir /home/nilay/examen_ing_de_sw_n_data_final/dbt'}
[0m02:34:07.917183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9d0b03950>]}
[0m02:34:08.216229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9dd04f620>]}
[0m02:34:08.232749 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:08.544402 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:34:08.933656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:34:08.934609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:34:09.042984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9d0a66450>]}
[0m02:34:09.307565 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:34:09.318834 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:34:09.393218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9ba741100>]}
[0m02:34:09.394380 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m02:34:09.395413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9ba930a40>]}
[0m02:34:09.400329 [info ] [MainThread]: 
[0m02:34:09.401832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:34:09.402621 [info ] [MainThread]: 
[0m02:34:09.404219 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:34:09.418193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m02:34:09.588643 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m02:34:09.589691 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m02:34:09.590517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:09.766751 [debug] [ThreadPool]: SQL status: OK in 0.176 seconds
[0m02:34:09.774327 [debug] [ThreadPool]: On list_medallion: Close
[0m02:34:09.776802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m02:34:09.778453 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m02:34:09.801295 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:34:09.802350 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m02:34:09.803192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:09.808640 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:34:09.813651 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:34:09.815253 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m02:34:09.817813 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:34:09.818775 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:34:09.819625 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m02:34:09.826521 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m02:34:09.829546 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:34:09.830719 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m02:34:09.832008 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m02:34:09.835130 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:34:09.836122 [debug] [ThreadPool]: On create_medallion_main: Close
[0m02:34:09.843477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m02:34:09.861032 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:34:09.862378 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m02:34:09.863142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:09.866656 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:34:09.868829 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m02:34:09.870168 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m02:34:09.937812 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m02:34:09.942363 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m02:34:09.948191 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m02:34:09.949217 [debug] [ThreadPool]: On list_medallion_main: Close
[0m02:34:09.951830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9ba734bc0>]}
[0m02:34:09.953276 [debug] [MainThread]: Using duckdb connection "master"
[0m02:34:09.954018 [debug] [MainThread]: On master: BEGIN
[0m02:34:09.954844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:09.957368 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:34:09.958306 [debug] [MainThread]: On master: COMMIT
[0m02:34:09.959501 [debug] [MainThread]: Using duckdb connection "master"
[0m02:34:09.960326 [debug] [MainThread]: On master: COMMIT
[0m02:34:09.961951 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:34:09.962637 [debug] [MainThread]: On master: Close
[0m02:34:09.984773 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m02:34:09.986658 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m02:34:09.988118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m02:34:09.989229 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m02:34:10.023450 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m02:34:10.025859 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m02:34:10.123006 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m02:34:10.125192 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:34:10.126645 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m02:34:10.127415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:10.130026 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:34:10.131488 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m02:34:10.132378 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:34:10.158440 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/nilay/examen_ing_de_sw_n_data_final/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m02:34:10.160283 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:34:10.161541 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m02:34:10.181772 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m02:34:10.183108 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m02:34:10.189220 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:34:10.195313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c73591b-2d7d-4c85-a43a-afb5a18052b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9b9b59fa0>]}
[0m02:34:10.197546 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.20s]
[0m02:34:10.199085 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m02:34:10.200611 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m02:34:10.204805 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m02:34:10.208336 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m02:34:10.209885 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m02:34:10.216281 [debug] [MainThread]: Using duckdb connection "master"
[0m02:34:10.217728 [debug] [MainThread]: On master: BEGIN
[0m02:34:10.218383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:34:10.224008 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m02:34:10.225278 [debug] [MainThread]: On master: COMMIT
[0m02:34:10.226128 [debug] [MainThread]: Using duckdb connection "master"
[0m02:34:10.227383 [debug] [MainThread]: On master: COMMIT
[0m02:34:10.229882 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:34:10.231239 [debug] [MainThread]: On master: Close
[0m02:34:10.232837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:10.233866 [debug] [MainThread]: Connection 'create_medallion_main' was properly closed.
[0m02:34:10.234523 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m02:34:10.235589 [info ] [MainThread]: 
[0m02:34:10.236421 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m02:34:10.238014 [debug] [MainThread]: Command end result
[0m02:34:10.309612 [debug] [MainThread]: Wrote artifact WritableManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/manifest.json
[0m02:34:10.316047 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/semantic_manifest.json
[0m02:34:10.334742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/nilay/examen_ing_de_sw_n_data_final/dbt/target/run_results.json
[0m02:34:10.338132 [info ] [MainThread]: 
[0m02:34:10.339831 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:34:10.341057 [info ] [MainThread]: 
[0m02:34:10.342300 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m02:34:10.343823 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m02:34:10.344848 [info ] [MainThread]: 
[0m02:34:10.346211 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m02:34:10.347373 [info ] [MainThread]: 
[0m02:34:10.348526 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m02:34:10.351025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1877675, "process_in_blocks": "0", "process_kernel_time": 3.056244, "process_mem_max_rss": "152568", "process_out_blocks": "2176", "process_user_time": 8.072947}
[0m02:34:10.352788 [debug] [MainThread]: Command `dbt run` failed at 02:34:10.352471 after 4.19 seconds
[0m02:34:10.354030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9dc630da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9ba9301a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9dce0af30>]}
[0m02:34:10.355423 [debug] [MainThread]: Flushing usage events
[0m02:34:11.326262 [debug] [MainThread]: An error was encountered while trying to flush usage events
